plugin:
  name: fylr_example
  version: "2"
  l10n: l10n/example-loca.csv
  webfrontend:
    url: FylrExample.js
    css: FyleExample.css
    html: FylrExample.html
  custom:
    henk: denk
  displayname:
    de-DE: FYLR-Example
    en-US: FYLR-Example

base_url_prefix: "webfrontend"

extensions:
  dump/empty:
    exec:
      service: "node"
      commands:
        - prog: "node"
          stdin:
            type: "body"
          stdout:
            type: "body"
          args:
            - type: "value"
              value: "server/extension/empty.js"

  dump/sleep:
    exec:
      service: "python"
      commands:
        - prog: "python"
          stdout:
            type: "body"
          args:
            - type: "value"
              value: "server/extension/sleep.py"

  dump/info:
    exec:
      service: "node"
      commands:
        - prog: "node"
          stdin:
            type: "body"
          stdout:
            type: "body"
          args:
            - type: "value"
              value: "server/extension/dump_info.js"
            - type: "value"
              value: "%info.json%"

  dump/error:
    exec:
      service: "node"
      commands:
        - prog: "node"
          stdin:
            type: "body"
          stdout:
            type: "body"
          args:
            - type: "value"
              value: "server/extension/error.js"

  dump/file:
    exec:
      service: "node"
      commands:
        - prog: "node"
          stdin:
            type: "body"
          stdout:
            type: "body"
          args:
            - type: "value"
              value: "server/extension/stdin_to_file.js"
            - type: "value"
              value: "/tmp/record.log"
            - type: "value"
              value: "%info.json%"

  webhook/set_comment:
    exec:
      service: "node"
      commands:
        - prog: "node"
          stdin:
            type: "body"
          stdout:
            type: "body"
          args:
            - type: "value"
              value: "server/db_pre_save+webhook/set_comment.js"
            - type: "value"
              value: "%info.json%"

callbacks:
  export_transport:
    copy_file:
      exec:
        timeoutSec: 60
        service: "node"
        commands:
          - prog: "node"
            stdout:
              type: body
            args:
              - type: "value"
                value: "server/export_transport/copy_file.js"
              - type: "value"
                value: "%info.json%"
    module_missing:
      exec:
        timeoutSec: 120
        service: "node"
        commands:
          - prog: "node"
            stdout:
              type: body
            args:
              - type: "value"
                value: "server/export_transport/_missing_.js"
    error:
      exec:
        timeoutSec: 60
        service: "node"
        commands:
          - prog: "node"
            stdout:
              type: body
            args:
              - type: "value"
                value: "server/export_transport/error.js"
              - type: "value"
                value: "%info.json%"

  export:
    module_missing:
      exec:
        timeoutSec: 120
        service: "node"
        commands:
          - prog: "node"
            stdout:
              type: body
            args:
              - type: "value"
                value: "server/export/_missing_.js"
    md5_sums:
      exec:
        timeoutSec: 120
        service: "node"
        commands:
          - prog: "node"
            stdout:
              type: body
            args:
              - type: "value"
                value: "--max-http-header-size=1000000"
              - type: "value"
                value: "server/export/md5_sums.js"
              - type: "value"
                value: "%info.json%"
    error:
      exec:
        timeoutSec: 120
        service: "node"
        commands:
          - prog: "node"
            stdout:
              type: body
            args:
              - type: "value"
                value: "server/export/error.js"
              - type: "value"
                value: "%info.json%"

  transition_db_pre_save:
    set_comment:
      exec:
        service: "node"
        commands:
          - prog: "node"
            stdin:
              type: body
            stdout:
              type: body
            args:
              - type: "value"
                value: "server/db_pre_save+webhook/set_comment.js"

  db_pre_save:
    exec:
      service: "node"
      commands:
        - prog: "node"
          stdin:
            type: body
          stdout:
            type: body
          args:
            - type: "value"
              value: "server/db_pre_save+webhook/set_comment.js"

base_config:
  - name: comment
    parameters:
      value:
        type: text
        position: 0

system_rights:
  - name: example_right
    comment: this right was added by the FYLR example plugin
    parameters:
      - name: bool
        type: bool
      - name: int
        type: int
      - name: text
        type: text
      - name: string-list
        type: string-list
        choices: [ a, b, c ]
      - name: string-list-one
        type: string-list-one
        choices: [ a, b, c ]
      - name: string-list-one-or-zero
        type: string-list-one-or-zero
        choices: [ a, b, c ]
      - name: mask-select
        type: mask-select
      - name: objecttype-select
        type: objecttype-select
      - name: eas-column-select
        type: eas-column-select
      - name: pool-select
        type: pool-select
      - name: preview-versions
        type: preview-versions

custom_types:
  example:
    config:
      schema:
        - name: fylr_example_config
          parameters:
            value:
              type: bool
      mask:
        - name: fylr_example_config
          parameters:
            value:
              type: bool
    update:
      exec:
        service: "node"
        commands:
          - prog: "node"
            stdin:
              type: body
            stdout:
              type: body
            args:
              - type: "value"
                value: "customDataTypeUpdater/update.js"
              - type: "value"
                value: "%info.json%"
      timeout: 60
      batch_size: 10
      expires_days: 1

fas_config:
  produce_config: custom_produce.yml
  cookbooks:
    - cookbook_metadata_example.yml
    - cookbook_metadata_pdf2text.yml
    - cookbook_grayscale.yml




